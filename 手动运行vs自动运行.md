# 手动运行 vs 自动运行 - 详细说明

## 📋 概述

在GitHub Actions中，RSS监控脚本支持两种运行方式：

1. **自动运行**（Schedule）- 定时自动触发
2. **手动运行**（Workflow Dispatch）- 手动点击触发

## 🔄 自动运行（Schedule）

### 配置方式

在 `.github/workflows/rss-monitor.yml` 中配置：

```yaml
on:
  schedule:
    # 每5分钟运行一次
    - cron: '*/5 * * * *'
```

### 特点

✅ **自动执行**：无需人工干预，GitHub会自动按时间表运行  
✅ **持续监控**：24/7不间断监控RSS源  
✅ **及时推送**：新文章发布后，最多5分钟内就能收到推送  
✅ **无需操作**：设置好后完全自动化

### 运行时间

- **当前设置**：每5分钟运行一次
- **运行时间**：全天候运行，包括周末和节假日
- **触发时间**：基于UTC时间（协调世界时）

### 示例时间表

```
00:00 UTC - 运行
00:05 UTC - 运行
00:10 UTC - 运行
00:15 UTC - 运行
...（每5分钟一次）
```

### 适用场景

- ✅ 需要持续监控RSS源
- ✅ 希望及时收到新文章推送
- ✅ 不需要人工干预
- ✅ 适合长期运行

### 注意事项

⚠️ **GitHub Actions运行时间限制**：
- 私有仓库：每月2000分钟免费额度
- 公开仓库：无限制
- 每次运行约1-2分钟，每5分钟一次，每天约288次

⚠️ **RSS源访问频率**：
- 过于频繁的访问可能触发某些网站的限流
- 建议根据实际需求调整频率

---

## 👆 手动运行（Workflow Dispatch）

### 配置方式

在 `.github/workflows/rss-monitor.yml` 中配置：

```yaml
on:
  workflow_dispatch:  # 允许手动触发
```

### 特点

✅ **按需运行**：想什么时候运行就什么时候运行  
✅ **即时执行**：点击后立即开始运行  
✅ **测试方便**：适合测试配置是否正确  
✅ **节省资源**：不占用自动运行的时间配额

### 如何手动触发

1. **访问GitHub仓库的Actions页面**
   - 地址：https://github.com/waynegxxx/discord/actions

2. **选择工作流**
   - 在左侧列表中找到 "RSS监控推送" 工作流
   - 点击进入

3. **点击运行按钮**
   - 点击右上角的 "Run workflow" 按钮
   - 选择分支（通常是 `main`）
   - 点击绿色的 "Run workflow" 按钮

4. **查看运行结果**
   - 工作流会立即开始运行
   - 可以实时查看运行日志
   - 运行完成后查看结果

### 运行时间

- **触发时间**：你点击按钮的时间
- **运行频率**：无限制，想运行多少次都可以
- **执行速度**：点击后几秒内开始运行

### 适用场景

- ✅ 测试配置是否正确
- ✅ 调试RSS源问题
- ✅ 临时需要检查新文章
- ✅ 不想等待自动运行
- ✅ 验证修改后的配置

### 注意事项

⚠️ **需要手动操作**：每次都需要去GitHub点击  
⚠️ **不会自动运行**：如果忘记手动触发，就不会检查新文章

---

## 📊 对比表格

| 特性 | 自动运行（Schedule） | 手动运行（Dispatch） |
|------|---------------------|---------------------|
| **触发方式** | 定时自动触发 | 手动点击触发 |
| **运行频率** | 每5分钟一次 | 无限制 |
| **是否需要操作** | ❌ 不需要 | ✅ 需要 |
| **及时性** | ✅ 自动及时 | ⚠️ 需要记得操作 |
| **测试方便性** | ⚠️ 需要等待 | ✅ 立即运行 |
| **资源消耗** | 持续消耗 | 按需消耗 |
| **适用场景** | 长期监控 | 测试/调试 |

---

## 🎯 使用建议

### 推荐配置：两者结合

**最佳实践**：
- ✅ **启用自动运行**：用于日常持续监控
- ✅ **保留手动运行**：用于测试和调试

### 具体场景

#### 场景1：日常使用
- **主要使用**：自动运行
- **辅助使用**：手动运行（测试时）

#### 场景2：测试阶段
- **主要使用**：手动运行
- **测试完成后**：启用自动运行

#### 场景3：调试问题
- **使用**：手动运行
- **原因**：可以立即看到结果，方便调试

#### 场景4：节省资源
- **使用**：只使用手动运行
- **原因**：如果不需要持续监控，可以关闭自动运行

---

## 🔧 如何修改配置

### 修改自动运行频率

编辑 `.github/workflows/rss-monitor.yml`：

```yaml
on:
  schedule:
    # 每5分钟运行一次
    - cron: '*/5 * * * *'    # 改为 */10 就是每10分钟
    # 每30分钟运行一次
    # - cron: '*/30 * * * *'
```

### 关闭自动运行

如果你想只使用手动运行，可以注释掉schedule：

```yaml
on:
  # schedule:
  #   # 每5分钟运行一次
  #   - cron: '*/5 * * * *'
  workflow_dispatch:  # 只保留手动触发
```

### 只使用自动运行

如果你想只使用自动运行（不推荐，因为无法手动测试），可以移除workflow_dispatch：

```yaml
on:
  schedule:
    - cron: '*/5 * * * *'
  # workflow_dispatch:  # 注释掉手动触发
```

---

## 📝 常见问题

### Q: 自动运行和手动运行会冲突吗？

**A:** 不会。它们是独立的：
- 自动运行按时间表执行
- 手动运行按需执行
- 可以同时运行多个实例（GitHub Actions支持并发）

### Q: 手动运行会触发自动运行吗？

**A:** 不会。它们是独立的触发方式：
- 手动运行不会影响自动运行的时间表
- 自动运行也不会影响手动运行

### Q: 如何知道是自动运行还是手动运行？

**A:** 在GitHub Actions的运行记录中可以看到：
- 自动运行会显示 "Scheduled" 标签
- 手动运行会显示 "Manual" 标签和触发者信息

### Q: 可以同时运行多个实例吗？

**A:** 可以。GitHub Actions支持并发运行：
- 如果自动运行正在进行，手动运行也会同时执行
- 每个运行实例都是独立的

### Q: 手动运行会保存状态吗？

**A:** 会。手动运行和自动运行使用同一个状态文件：
- 都会读取 `rss_state.json`
- 都会更新 `rss_state.json`
- 避免重复推送

---

## 💡 最佳实践建议

1. **保持两者都启用**
   - 自动运行用于日常监控
   - 手动运行用于测试和调试

2. **合理设置频率**
   - 根据实际需求调整自动运行频率
   - 不要设置太频繁（避免浪费资源）

3. **定期检查运行记录**
   - 查看是否有运行失败
   - 及时发现问题

4. **测试时使用手动运行**
   - 修改配置后，先手动运行测试
   - 确认无误后再等待自动运行

---

## 🔗 相关资源

- **GitHub Actions文档**：https://docs.github.com/en/actions
- **Cron表达式说明**：https://crontab.guru/
- **工作流运行记录**：https://github.com/waynegxxx/discord/actions

